function initNavigation(){const e=document.getElementById("header"),t=document.getElementById("navToggle"),n=document.getElementById("nav"),i=document.querySelectorAll(".nav-link");window.addEventListener("scroll",()=>{window.scrollY>50?e.classList.add("scrolled"):e.classList.remove("scrolled")}),t&&t.addEventListener("click",()=>{const e=n.classList.toggle("active");t.classList.toggle("active"),t.setAttribute("aria-expanded",e)}),i.forEach(e=>{e.addEventListener("click",()=>{n.classList.remove("active"),t.classList.remove("active"),t.setAttribute("aria-expanded","false")})});const o=document.querySelectorAll("section[id]");window.addEventListener("scroll",()=>{const e=window.scrollY;o.forEach(t=>{const n=t.offsetHeight,o=t.offsetTop-100,c=t.getAttribute("id"),a=document.querySelector(`.nav-link[href="#${c}"]`);e>o&&e<=o+n&&(i.forEach(e=>e.classList.remove("active")),a&&a.classList.add("active"))})})}function initPortfolio(){const e=document.getElementById("portfolioGrid");e&&portfolioData&&portfolioData.projects?portfolioData.projects.forEach(t=>{const n=createProjectCard(t);e.appendChild(n)}):console.warn("Portfolio grid or data not found")}function createProjectCard(e){const t=document.createElement("div");return t.className="portfolio-item",t.innerHTML=`\n        <div class="portfolio-image">\n            <img src="${e.image}" alt="${e.title}" loading="lazy">\n            <div class="portfolio-overlay">\n                <span class="portfolio-category">${e.category}</span>\n            </div>\n        </div>\n        <div class="portfolio-content">\n            <h3>${e.title}</h3>\n            <p>${e.description}</p>\n        </div>\n    `,t.addEventListener("mouseenter",()=>{t.style.transform="translateY(-10px)"}),t.addEventListener("mouseleave",()=>{t.style.transform="translateY(0)"}),t}function initScrollAnimations(){const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll("\n        .service-card,\n        .portfolio-item,\n        .skill-category,\n        .contact-item,\n        .stat-item\n    ").forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="opacity 0.6s ease, transform 0.6s ease",e.observe(t)})}function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t)return;e.preventDefault();const n=document.querySelector(t);if(n){const e=n.offsetTop-80;window.scrollTo({top:e,behavior:"smooth"})}})})}function debounce(e,t){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...i)},t)}}function initLazyLoading(){const e=document.querySelectorAll('img[loading="lazy"]');if("IntersectionObserver"in window){const t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src||n.src,t.unobserve(n)}})});e.forEach(e=>t.observe(e))}}function initCV(){loadExperiences(),loadEducation(),loadCertifications()}async function loadExperiences(){const e=document.getElementById("experienceTimeline");if(e)try{const t=await fetch("/api/portfolio/experience"),n=await t.json();n.success&&n.data&&(e.innerHTML="",n.data.forEach(t=>{e.appendChild(createCVItem(t,"experience"))}))}catch(t){console.error("Erreur chargement exp√©riences:",t),e.innerHTML='<p style="color: var(--gray-500); padding: 1rem;">Donn√©es en cours de chargement...</p>'}}async function loadEducation(){const e=document.getElementById("educationTimeline");if(e)try{const t=await fetch("/api/portfolio/education"),n=await t.json();n.success&&n.data&&(e.innerHTML="",n.data.forEach(t=>{e.appendChild(createCVItem(t,"education"))}))}catch(e){console.error("Erreur chargement formations:",e)}}async function loadCertifications(){const e=document.getElementById("certificationsTimeline");if(e)try{const t=await fetch("/api/portfolio/certifications"),n=await t.json();n.success&&n.data&&n.data.length>0&&n.data.forEach(t=>{e.appendChild(createCVItem(t,"certification"))})}catch(e){console.error("Erreur chargement certifications:",e)}}function createCVItem(e,t){const n=document.createElement("div");if(n.className="cv-item","experience"===t){const t=e.current?"cv-item-date cv-item-current":"cv-item-date",i=e.current?"Pr√©sent":e.endDate;n.innerHTML=`\n            <div class="cv-item-header">\n                <div>\n                    <h4 class="cv-item-title">${e.position}</h4>\n                    <p class="cv-item-subtitle">${e.company} ‚Ä¢ ${e.location||""}</p>\n                </div>\n                <span class="${t}">${e.startDate} - ${i}</span>\n            </div>\n            <p class="cv-item-description">${e.description||""}</p>\n            ${e.achievements&&e.achievements.length>0?`\n                <ul class="cv-item-achievements">\n                    ${e.achievements.map(e=>`<li>${e}</li>`).join("")}\n                </ul>\n            `:""}\n        `}else"education"===t?n.innerHTML=`\n            <div class="cv-item-header">\n                <div>\n                    <h4 class="cv-item-title">${e.degree}</h4>\n                    <p class="cv-item-subtitle">${e.institution} ‚Ä¢ ${e.location||""}</p>\n                </div>\n                <span class="cv-item-date">${e.startDate} - ${e.endDate}</span>\n            </div>\n            ${e.description?`<p class="cv-item-description">${e.description}</p>`:""}\n        `:"certification"===t&&(n.innerHTML=`\n            <div class="cv-item-header">\n                <div>\n                    <h4 class="cv-item-title">${e.name}</h4>\n                    <p class="cv-item-subtitle">${e.issuer}</p>\n                </div>\n                <span class="cv-item-date">${e.date}</span>\n            </div>\n        `);return n}function initProjects(){loadProjects(),initProjectFilters()}async function loadProjects(){const e=document.getElementById("projectsGrid");if(e)try{const t=await fetch("/api/portfolio/projects"),n=await t.json();n.success&&n.data&&(e.innerHTML="",n.data.forEach(t=>{e.appendChild(createProjectCard(t))}))}catch(t){console.error("Erreur chargement projets:",t),e.innerHTML='<p style="color: var(--gray-500); padding: 2rem; text-align: center; grid-column: 1/-1;">Projets en cours de chargement...</p>'}}function createProjectCard(e){const t=document.createElement("div");t.className="project-card",t.dataset.category=e.category||"cloud";const n=e.technologies?e.technologies.split(",").map(e=>`<span class="tech-tag">${e.trim()}</span>`).join(""):"";return t.innerHTML=`\n        <div class="project-image">\n            <img src="${e.image||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=600&q=80"}"\n                 alt="${e.title}" loading="lazy">\n            <span class="project-category">${e.category||"Cloud"}</span>\n        </div>\n        <div class="project-content">\n            <h3 class="project-title">${e.title}</h3>\n            <p class="project-description">${e.description||""}</p>\n            ${n?`<div class="project-tech">${n}</div>`:""}\n            <div class="project-links">\n                ${e.link?`<a href="${e.link}" target="_blank" class="project-link">\n                    <i class="fas fa-external-link-alt"></i> Voir le projet\n                </a>`:""}\n                ${e.github?`<a href="${e.github}" target="_blank" class="project-link">\n                    <i class="fab fa-github"></i> Code source\n                </a>`:""}\n            </div>\n        </div>\n    `,t}function initProjectFilters(){const e=document.querySelectorAll(".filter-btn"),t=document.querySelectorAll(".project-card");e.forEach(n=>{n.addEventListener("click",()=>{const i=n.dataset.filter;e.forEach(e=>e.classList.remove("active")),n.classList.add("active"),t.forEach(e=>{"all"===i||e.dataset.category===i?e.style.display="block":e.style.display="none"})})})}function initBlog(){initBlogFilters()}function initBlogFilters(){const e=document.querySelectorAll(".category-btn"),t=document.querySelectorAll(".blog-card");e.forEach(n=>{n.addEventListener("click",()=>{const i=n.dataset.category;e.forEach(e=>e.classList.remove("active")),n.classList.add("active"),t.forEach(e=>{const t=e.dataset.category;"all"===i||t.includes(i)?e.style.display="flex":e.style.display="none"})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/portofolio/sw.js").then(e=>{console.log("‚úÖ Service Worker enregistr√©:",e.scope),setInterval(()=>{e.update()},36e5),e.addEventListener("updatefound",()=>{const t=e.installing;console.log("üîÑ Nouvelle version du Service Worker d√©tect√©e"),t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("‚úÖ Nouvelle version install√©e"),confirm("Une nouvelle version est disponible. Recharger la page?")&&window.location.reload())})})}).catch(e=>{console.error("‚ùå Erreur enregistrement Service Worker:",e)})}),document.addEventListener("DOMContentLoaded",()=>{initNavigation(),initProjects(),initBlog(),initPortfolio(),initScrollAnimations(),initSmoothScroll()}),initLazyLoading();